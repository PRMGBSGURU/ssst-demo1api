### Base URL
@baseUrl = http://localhost:3000
@contentType = application/json

### 1. Health Check
GET {{baseUrl}}/

### 2. Login - Admin User
POST {{baseUrl}}/login
Content-Type: {{contentType}}

{
  "username": "admin",
  "password": "password123"
}

### 3. Login - Regular User
POST {{baseUrl}}/login
Content-Type: {{contentType}}

{
  "username": "user",
  "password": "user123"
}

### 4. Login - Invalid Credentials (Will fail)
POST {{baseUrl}}/login
Content-Type: {{contentType}}

{
  "username": "admin",
  "password": "wrongpassword"
}

### 5. Database User Login (MySQL Validation)
POST {{baseUrl}}/userlogin
Content-Type: {{contentType}}

{
  "emailid": "user@example.com",
  "password": "your_password_here"
}

### 6. User Registration (New Endpoint)
POST {{baseUrl}}/newregistration
Content-Type: {{contentType}}

{
  "surname": "Doe",
  "lastname": "John",
  "emailid": "john.doe@example.com",
  "gender": "Male",
  "mobilenumber": "+911234567890",
  "whatsappnumber": "+911234567890",
  "password": "SecurePassword123!"
}

### 7. User Registration - Example 2
POST {{baseUrl}}/newregistration
Content-Type: {{contentType}}

{
  "surname": "Smith",
  "lastname": "Jane",
  "emailid": "jane.smith@example.com",
  "gender": "Female",
  "mobilenumber": "+919876543210",
  "whatsappnumber": "+919876543210",
  "password": "AnotherSecurePass123!"
}

### 8. Access Protected Route (Replace TOKEN with actual token from login)
GET {{baseUrl}}/protected
Authorization: Bearer TOKEN

### 9. Get User Profile (Protected)
GET {{baseUrl}}/profile
Authorization: Bearer TOKEN

### ============================================================================
### PASSWORD RESET API TESTS
### ============================================================================

### 10. Request OTP for Password Reset
POST {{baseUrl}}/passwordreset/request-otp
Content-Type: {{contentType}}

{
  "emailId": "user@example.com"
}

### 11. Verify OTP and Reset Password
POST {{baseUrl}}/passwordreset/verify-otp
Content-Type: {{contentType}}

{
  "emailId": "user@example.com",
  "otp": "123456",
  "newPassword": "NewSecurePassword123"
}

### 12. Request OTP - Alternative User
POST {{baseUrl}}/passwordreset/request-otp
Content-Type: {{contentType}}

{
  "emailId": "admin@example.com"
}

### 13. Verify OTP - With Invalid OTP (will fail)
POST {{baseUrl}}/passwordreset/verify-otp
Content-Type: {{contentType}}

{
  "emailId": "user@example.com",
  "otp": "000000",
  "newPassword": "NewSecurePassword123"
}

### 14. Check OTP Status for User
GET {{baseUrl}}/passwordreset/otp-status/1

### ============================================================================
### SESSION MANAGEMENT & LOGOUT API TESTS (NEW)
### ============================================================================

### 15. Login and Create Session - Admin User
POST {{baseUrl}}/login
Content-Type: {{contentType}}

{
  "username": "admin",
  "password": "password123"
}

### 16. Check Session Status (Use token from login #15 or #2)
### Replace TOKEN with actual token from login response
GET {{baseUrl}}/session-status
Authorization: Bearer TOKEN

### 17. Get All Active Sessions (Admin Endpoint)
### Shows all currently active sessions in the system
GET {{baseUrl}}/sessions
Authorization: Bearer TOKEN

### 18. Logout Current Session (Use token from any login)
### This invalidates the current session and logs out the user
POST {{baseUrl}}/logout
Content-Type: {{contentType}}
Authorization: Bearer TOKEN

### 19. Logout All User Sessions
### Invalidates all active sessions for the current user
### Useful when user suspects unauthorized access
POST {{baseUrl}}/logout-all
Content-Type: {{contentType}}
Authorization: Bearer TOKEN

### 20. Try Accessing Protected Route with Logged Out Token (Should Fail)
### This should return 401 "Session expired or not found"
GET {{baseUrl}}/protected
Authorization: Bearer TOKEN

### ============================================================================
### SESSION MANAGEMENT - INACTIVITY TIMEOUT TEST
### ============================================================================
### 
### Test Scenario: Verify 15-minute inactivity logout
### 
### 1. Login (request #2 or #15) - Save the token
### 2. Wait 15+ minutes without making any API calls
### 3. Try accessing protected resource (request #20)
### 4. Expected: Session should be auto-logged out
### 5. You should see 401 error: "Session expired or not found"
###
### OR view active sessions (request #17) to see inactivityMinutes counter
### When inactivityMinutes >= 15, the session will be removed on next cleanup
###

### Notes:
###
### Session Management Features:
### 1. Inactivity Timeout: 15 minutes (900 seconds)
### 2. Automatic Cleanup: Every 5 minutes
### 3. Activity Tracking: Updated on every API request
### 4. Session Creation: Includes sessionId, timestamp, IP address
###
### Testing with VS Code REST Client:
### 1. Login to get a fresh token (request #2)
### 2. Copy token from response
### 3. In other requests, replace "TOKEN" with the actual token
### 4. Paste token in Authorization header: Bearer <token>
### 5. Use Ctrl+Alt+R (or Cmd+Alt+R on Mac) to send request
###
### Session Status Fields:
### - sessionId: Unique session identifier
### - inactivityMinutes: Minutes since last activity
### - remainingMinutesBeforeLogout: Minutes until auto-logout
### - timeoutMinutes: Total timeout duration (15 minutes)
###
### Logout Responses:
### Success:
### {
###   "success": true,
###   "message": "Logout successful",
###   "data": {
###     "sessionId": "sess_...",
###     "sessionDuration": 1200 (seconds)
###   }
### }
###
### Error (Session not found):
### {
###   "success": false,
###   "message": "Session expired or not found. Please login again."
### }
###
###
### For /userlogin endpoint:
### 1. Make sure MySQL database "ssst-demo1" exists locally
### 2. Make sure "Users" table has "EmailID" and "Password" columns
### 3. Update emailid and password with actual database values
### 4. Password can be plain text or bcrypt hashed
###
### For token-based endpoints:
### 1. First, login with /login or /userlogin to get a token
### 2. Copy the token value from the response
### 3. Replace "TOKEN" in the protected route requests with the actual token
### 4. You can use VS Code REST Client extension to run these requests
###    Install: "REST Client" by Huachao Mao
###
### For Password Reset:
### 1. First, run "Request OTP for Password Reset" (request #10)
### 2. Check console logs for the generated OTP (in development mode)
### 3. Copy OTP and update request #11 with the actual OTP code
### 4. Run "Verify OTP and Reset Password" to complete password reset
### 5. Monitor email/SMS for actual OTP delivery
###
